<div class="search">
  <md-toolbar>
    <div class="md-toolbar-tools">
      <h2>
        Search for help
      </h2>
    </div>
  </md-toolbar>

  <loading-indicator loading="$ctrl.loading"></loading-indicator>

  <md-content>

    <div md-colors="{background: 'primary-50'}" layout="column" layout-padding>

      <form
        name="$ctrl.searchForm"
        role="form"
        class="compact"
        ng-submit="$ctrl.search()"
        layout="row" layout-align="start center" layout-padding>
        <md-input-container
          class="md-icon-float md-block md-title compact hide-error-spacer"
          md-no-float
          flex
          layout="row" layout-align="start center">
          <input
            ng-model="$ctrl.searchText"
            placeholder="Search..."
            flex>
        </md-input-container>
        <div>
          <md-button
            type="submit"
            class="md-primary md-raised"
            aria-label="Perform search"
            ng-disabled="!$ctrl.searchText">
            Search
          </md-button>
          <md-button
            class="md-raised"
            aria-label="Clear search"
            ng-click="$ctrl.clear()"
            ng-disabled="!$ctrl.searchText">
            Clear
          </md-button>
        </div>
      </form>

    </div>

    <p
      ng-if="$ctrl.query && !$ctrl.initialState && !$ctrl.results.length"
      class="none-text"
      layout="row" layout-align="center center" layout-padding>
      No help items found
    </p>

    <h4
      ng-if="!$ctrl.query && $ctrl.results.length"
      layout="row" layout-align="center center" layout-padding
      style="padding-bottom: 0;">
      Suggestions
    </h4>

    <div class="search-results">
      <md-list flex>
        <ng-switch
          ng-repeat="item in $ctrl.results track by item.id"
          on="item.type">

          <!-- Support request -->
          <md-list-item
            ng-switch-when="support-request"
            ng-class="{
              'md-2-line': !item.content,
              'md-3-line md-long-text': item.content
            }"
            ui-sref="help.support.requests.new({id: item.hub_id})">
            <md-icon class="md-avatar-icon">{{$ctrl.supportRequestsIcon}}</md-icon>
            <div class="md-list-item-text" layout="column">
              <h3 ng-bind-html="item.title"></h3>
              <h4>
                <small class="badge" md-colors="{background: 'blue-grey-400'}">
                  Support request form
                </small>
              </h4>
              <p ng-if="item.content" ng-bind-html='item.content'></p>
            </div>
            <md-divider ng-if="!$last"></md-divider>
          </md-list-item>

          <!-- Doc -->
          <md-list-item
            ng-switch-when="doc"
            ng-class="{
              'md-2-line': !item.content,
              'md-3-line md-long-text': item.content
            }"
            ng-href="{{item.link}}"
            target="_blank">
            <md-icon class="md-avatar-icon">{{$ctrl.docsIcon}}</md-icon>
            <div class="md-list-item-text" layout="column">
              <h3 ng-bind-html="item.title"></h3>
              <h4>
                <small class="badge" md-colors="{background: 'blue-grey-400'}">
                  Documentation
                </small>
              </h4>
              <p ng-if="item.content" ng-bind-html='item.content'></p>
            </div>
            <md-divider ng-if="!$last"></md-divider>
          </md-list-item>

        </ng-switch>
      </md-list>
    </div>

  </md-content>
</div>
